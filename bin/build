#!/usr/bin/env ruby

require 'fileutils'

require_relative '../controllers/list_controller.rb'
require_relative '../controllers/genre_controller.rb'
require_relative '../controllers/index_controller.rb'
require_relative '../controllers/year_controller.rb'

"#{__dir__}/../site"
  .tap(&FileUtils.method(:remove_dir))
  .tap(&Dir.method(:mkdir))

entries = YAML.load_file("./data.yml")["entries"]

# Index & Lists
# ==============================================================================

IndexController.new(entries).call
ListController.new(entries).call

# Genres
# ==============================================================================

genres = %w(
  scifi
  sailing
)

genres.map(&GenreController.method(:new)).each(&:call)

# Years
# ==============================================================================

%w(2020).map(&YearController.method(:new)).each(&:call)


puts "Done"

