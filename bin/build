#!/usr/bin/env ruby

require 'yaml'

require_relative '../lib/report.rb'
require_relative '../lib/table.rb'
require_relative '../lib/validator.rb'

# PREP
# ==============================================================================
entries = YAML.load(File.read("./log.yml"))["entries"]

pages = %w(
  list.html
)

pages.each do |file|
  if File.exist?("./log/#{file}")
    File.delete("./log/#{file}")
  end
end

# LIST
# ==============================================================================
filtered_entries = entries.map { |entry| entry.slice("read", "title", "author") }
table = Table.new(filtered_entries).to_html
File.open("./log/list.html", "w") { |f| f.puts table }

# SCIFI
# ==============================================================================
# scifi_entries = entries.select { |entry| entry["genre"] == "scifi" }
# scifi_report = Report.new(scifi_entries).to_s
# puts scifi_report
# File.open("./reports/scifi.txt", "w") do |f| 
#   f.puts <<~REPORT
#     SCIFI READING REPORT
#    
#     #{scifi_report}
#   REPORT
# end

